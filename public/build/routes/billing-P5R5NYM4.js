import{a as le}from"/build/_shared/chunk-UVAS4STK.js";import{a as oe}from"/build/_shared/chunk-BDXHRB7C.js";import"/build/_shared/chunk-OCNP4HMK.js";import"/build/_shared/chunk-MGQ57324.js";import{a as He}from"/build/_shared/chunk-OCXPQHWM.js";import"/build/_shared/chunk-2ASNDYGS.js";import{a as _e}from"/build/_shared/chunk-63OPQ3LC.js";import{a as Te}from"/build/_shared/chunk-VZQVWFLO.js";import{a as A}from"/build/_shared/chunk-4GVLMWJ7.js";import{a as ae}from"/build/_shared/chunk-NAU26CU7.js";import{a as ie,b as re}from"/build/_shared/chunk-53PIVPIF.js";import{a as I}from"/build/_shared/chunk-A7SUEVP2.js";import{a as te}from"/build/_shared/chunk-PXEUFDPR.js";import"/build/_shared/chunk-LTBXYQR6.js";import"/build/_shared/chunk-243AYOFM.js";import{b as ee}from"/build/_shared/chunk-HAINM4MF.js";import{$c as Ue,_c as Z,hb as Q,ib as Le}from"/build/_shared/chunk-QH5UXTNE.js";import{Ba as Ye,ma as Ee,ya as G}from"/build/_shared/chunk-GO4RMXDG.js";import"/build/_shared/chunk-GZO74C6C.js";import{a as Ae}from"/build/_shared/chunk-5C6XY6QG.js";import"/build/_shared/chunk-P4GU2T66.js";import{p as W,q as Be}from"/build/_shared/chunk-WKVXRFKR.js";import{a as u,d as j,e as Ce}from"/build/_shared/chunk-6UMQ6VR5.js";import{F as z,N as v,ha as Ie}from"/build/_shared/chunk-DRCRQ7AX.js";import{n as Pe}from"/build/_shared/chunk-NSB5NZWW.js";import"/build/_shared/chunk-FQ2RG5VJ.js";import"/build/_shared/chunk-C4K24J7E.js";import"/build/_shared/chunk-YG2XDHGZ.js";import"/build/_shared/chunk-KOHXVCYB.js";import"/build/_shared/chunk-VGJ5EBYX.js";import"/build/_shared/chunk-MSGER76V.js";import"/build/_shared/chunk-Z3FUFQEO.js";import{m as q}from"/build/_shared/chunk-O7CS4SBR.js";import{C as V,Cb as De,D as J,Za as P,sa as C,ua as K,xa as X}from"/build/_shared/chunk-NSQYLWAQ.js";import{b as F,c as $}from"/build/_shared/chunk-4YJISJ47.js";import"/build/_shared/chunk-VOM23DNI.js";import"/build/_shared/chunk-5YEMDBLX.js";import"/build/_shared/chunk-X4RYED65.js";import"/build/_shared/chunk-2SDAKG4K.js";import{a as R,b as c}from"/build/_shared/chunk-TANAHWHW.js";import{e as o}from"/build/_shared/chunk-ADMCF34Z.js";var ge=o(Te());var s=o(R());Ce();var l=o(Ae()),me=o(_e()),ce=o(He());Ie();var ue=o(Ee());De();Ye();Ue();Be();var se=o(R());var ne=o(Pe()),k=o(c()),Oe=({progress:p,theme:g,className:y})=>(0,k.jsx)("div",{className:"relative","data-testid":"multiprogress",children:(0,k.jsx)("div",{className:ee("flex h-5 overflow-hidden rounded bg-gray-200 text-xs dark:bg-slate-600",y),children:(0,ne.default)(p,({value:d,lightColour:f,darkColour:i})=>(0,k.jsx)("div",{style:{width:`${d}%`,backgroundColor:g==="dark"?i:f},className:"flex flex-col justify-center whitespace-nowrap text-center text-white shadow-none"},`${d}-${f}-${i}`))})}),de=(0,se.memo)(Oe);Le();var e=o(c());l.default.extend(me.default);l.default.extend(ce.default);var Re=({ssrAuthenticated:p,ssrTheme:g})=>{let[y,d]=(0,s.useState)(!1),{metainfo:f,usageinfo:i}=u(a=>a.ui.misc),{user:x,loading:E}=u(a=>a.auth),{theme:he}=u(a=>a.ui.theme),N=C?he:g,Y=u(a=>a.ui.misc.paddleLoaded),be=u(a=>a.auth.authenticated),L=j(),ve=Z(),{t,i18n:{language:r}}=$("common"),ke=C?be:p,{nextBillDate:w,planCode:B,subUpdateURL:h,trialEndDate:n,timeFormat:M,cancellationEffectiveDate:S,subCancelURL:b,maxEventsCount:m}=x,U=x.planCode!=="none"&&x.planCode!=="trial"&&x.planCode!=="free",D=B==="trial",ye=B==="none",Ne=(0,ue.default)(i.total/m*100,2)||0;(0,s.useEffect)(()=>{if(Y)return;G(V);let a=Se=>{ve(Q.setPaddleLastEvent(Se))},T=setInterval(O,200);function O(){X?clearInterval(T):window!=null&&window.Paddle&&(window.Paddle.Setup({vendor:J,eventCallback:a}),clearInterval(T))}},[Y]),(0,s.useEffect)(()=>{L(W.loadUsageinfo())},[L]);let _=(0,s.useMemo)(()=>{if(!n)return!1;let a=l.default.utc();return l.default.utc(n).diff(a)<0},[n]),H=(0,s.useMemo)(()=>{if(!n||!D)return null;if(_)return t("pricing.trialEnded");let a;return r==="en"?M==="12-hour"?a=(0,l.default)(n).locale(r).format("MMMM D, h:mm A"):a=(0,l.default)(n).locale(r).format("MMMM D, HH:mm"):M==="12-hour"?a=(0,l.default)(n).locale(r).format("D MMMM, h:mm A"):a=(0,l.default)(n).locale(r).format("D MMMM, HH:mm"),t("billing.trialEnds",{date:a})},[r,n,D,M,_,t]),we=()=>{if(!window.Paddle){b&&window.location.replace(b);return}window.Paddle.Checkout.open({override:b,method:"inline",frameTarget:"checkout-container",frameInitialHeight:416,frameStyle:"width:100%; min-width:312px; background-color: #f9fafb; border: none; border-radius: 10px; margin-top: 10px;",locale:P[r]||r,displayModeTheme:N,country:f.country}),setTimeout(()=>{var a;(a=document.querySelector("#checkout-container"))==null||a.scrollIntoView()},500)},Me=()=>{if(!window.Paddle){h&&window.location.replace(h);return}window.Paddle.Checkout.open({override:h,method:"inline",frameTarget:"checkout-container",frameInitialHeight:416,frameStyle:"width:100%; min-width:312px; background-color: #f9fafb; border: none; border-radius: 10px; margin-top: 10px;",locale:P[r]||r,displayModeTheme:N,country:f.country}),setTimeout(()=>{var a;(a=document.querySelector("#checkout-container"))==null||a.scrollIntoView()},500)};return(0,e.jsxs)("div",{className:"min-h-page bg-gray-50 dark:bg-slate-900",children:[(0,e.jsx)(le,{}),(0,e.jsx)("div",{className:"mx-auto w-11/12 whitespace-pre-line px-4 pt-12 sm:px-6 md:w-5/6",children:(0,e.jsx)("h1",{className:"text-4xl font-extrabold tracking-tight text-gray-900 dark:text-gray-50",children:t("billing.title")})}),(0,e.jsxs)("div",{className:"mx-auto mt-5 grid w-11/12 gap-8 whitespace-pre-line px-4 pb-16 sm:px-6 md:w-5/6 lg:grid-cols-2",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("h2",{id:"billing",className:"mb-2 text-2xl font-medium tracking-tight text-gray-900 dark:text-gray-50",children:t("billing.subscription")}),(0,e.jsx)("p",{className:"mt-1 text-base tracking-tight text-gray-900 dark:text-gray-50",children:t(U?"billing.selectPlan":"billing.changePlan")}),(0,e.jsx)("p",{className:"max-w-prose text-base tracking-tight text-gray-900 dark:text-gray-50",children:t("billing.membersNotification")}),U&&w&&(0,e.jsx)("div",{className:"mt-5 max-w-prose rounded-md bg-blue-50 p-4 dark:bg-blue-600/30",children:(0,e.jsxs)("div",{className:"flex",children:[(0,e.jsx)("div",{className:"flex-shrink-0",children:(0,e.jsx)(v,{"aria-hidden":"true",className:"h-5 w-5 text-blue-400 dark:text-blue-100"})}),(0,e.jsx)("p",{className:"ml-3 text-sm font-medium text-blue-700 dark:text-blue-100",children:t("billing.nextBillDateIs",{date:r==="en"?(0,l.default)(w).locale(r).format("MMMM D, YYYY"):(0,l.default)(w).locale(r).format("D MMMM, YYYY")})})]})}),S&&(0,e.jsx)("div",{className:"mt-5 max-w-prose rounded-md bg-blue-50 p-4 dark:bg-blue-600/30",children:(0,e.jsxs)("div",{className:"flex",children:[(0,e.jsx)("div",{className:"flex-shrink-0",children:(0,e.jsx)(v,{"aria-hidden":"true",className:"h-5 w-5 text-blue-400 dark:text-blue-100"})}),(0,e.jsxs)("div",{className:"ml-3",children:[(0,e.jsx)("h3",{className:"text-sm font-medium text-blue-700 dark:text-blue-100",children:t("billing.subscriptionCancelled")}),(0,e.jsx)("p",{className:"mt-2 text-sm text-blue-700 dark:text-blue-100",children:t("billing.subscriptionCancelledDescription",{date:r==="en"?(0,l.default)(S).locale(r).format("MMMM D, YYYY"):(0,l.default)(S).locale(r).format("D MMMM, YYYY")})})]})]})}),D&&H&&(0,e.jsx)("div",{className:"mt-5 max-w-prose rounded-md bg-blue-50 p-4 dark:bg-blue-600/30",children:(0,e.jsxs)("div",{className:"flex",children:[(0,e.jsx)("div",{className:"flex-shrink-0",children:(0,e.jsx)(v,{"aria-hidden":"true",className:"h-5 w-5 text-blue-400 dark:text-blue-100"})}),(0,e.jsx)("p",{className:"ml-3 text-sm font-medium text-blue-700 dark:text-blue-100",children:H})]})}),ye&&(0,e.jsx)("div",{className:"mt-5 max-w-prose rounded-md bg-red-50 p-4 dark:bg-red-600/30",children:(0,e.jsxs)("div",{className:"flex",children:[(0,e.jsx)("div",{className:"flex-shrink-0",children:(0,e.jsx)(z,{"aria-hidden":"true",className:"h-5 w-5 text-red-400 dark:text-red-100"})}),(0,e.jsxs)("div",{className:"ml-3",children:[(0,e.jsx)("h3",{className:"text-sm font-medium text-red-800 dark:text-red-100",children:t("billing.noActiveSubscription")}),(0,e.jsx)("p",{className:"mt-2 text-sm text-red-700 dark:text-red-200",children:t("billing.noActiveSubscriptionDescription")})]})]})}),E?(0,e.jsx)(A,{}):(0,e.jsxs)("div",{className:"mt-8 flex flex-col",children:[(0,e.jsx)(oe,{authenticated:ke,isBillingPage:!0}),(0,e.jsxs)("div",{className:"mt-2 space-y-2",children:[h&&(0,e.jsx)(I,{className:"mr-2",onClick:Me,type:"button",primary:!0,large:!0,children:t("billing.update")}),b&&(0,e.jsx)(I,{onClick:()=>d(!0),type:"button",semiDanger:!0,large:!0,children:t("billing.cancelSub")})]})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h2",{id:"usage",className:"text-2xl font-medium tracking-tight text-gray-900 dark:text-gray-50",children:t("billing.planUsage")}),(0,e.jsx)("p",{className:"mt-1 max-w-prose text-base tracking-tight text-gray-900 dark:text-gray-50",children:t("billing.planUsageDesc")}),E?(0,e.jsx)(A,{}):(0,e.jsxs)("div",{className:"mt-2 text-lg tracking-tight text-gray-900 dark:text-gray-50",children:[(0,e.jsx)("p",{className:"mb-1 text-base font-medium tracking-tight text-gray-900 dark:text-gray-50",children:t("billing.xofy",{x:i.total||0,y:m||0})}),(0,e.jsx)(te,{text:(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{children:t("billing.usageOverview",{tracked:i.total||0,trackedPerc:Ne||0,maxEvents:m||0})}),(0,e.jsxs)("ul",{className:"mt-2 list-inside list-disc",children:[(0,e.jsx)("li",{className:"marker:text-blue-600 dark:marker:text-blue-800",children:t("billing.pageviews",{quantity:i.traffic||0,percentage:i.trafficPerc||0})}),(0,e.jsx)("li",{className:"marker:text-fuchsia-600 dark:marker:text-fuchsia-800",children:t("billing.customEvents",{quantity:i.customEvents||0,percentage:i.customEventsPerc||0})}),(0,e.jsx)("li",{className:"marker:text-lime-600 dark:marker:text-lime-800",children:t("billing.captcha",{quantity:i.captcha||0,percentage:i.captchaPerc||0})}),(0,e.jsx)("li",{className:"marker:text-red-600 dark:marker:text-red-800",children:t("billing.errors",{quantity:i.errors||0,percentage:i.errorsPerc||0})})]})]}),tooltipNode:(0,e.jsx)(de,{theme:N,className:"w-[85vw] max-w-[25rem]",progress:[{value:i.traffic===0?0:i.traffic/m*100,lightColour:"#2563eb",darkColour:"#1d4ed8"},{value:i.customEvents===0?0:i.customEvents/m*100,lightColour:"#c026d3",darkColour:"#a21caf"},{value:i.captcha===0?0:i.captcha/m*100,lightColour:"#65a30d",darkColour:"#4d7c0f"}]}),className:"!h-auto !w-max max-w-max"}),(0,e.jsx)("p",{className:"mt-1 text-base tracking-tight text-gray-900 dark:text-gray-50",children:t("billing.resetDate")})]})]})]}),(0,e.jsx)(ae,{onClose:()=>{d(!1)},onSubmit:()=>{d(!1),we()},submitText:t("common.yes"),closeText:t("common.no"),title:t("pricing.cancelTitle"),submitType:"danger",type:"error",message:(0,e.jsx)(F,{t,i18nKey:"pricing.cancelDesc",values:{email:K}}),isOpened:y})]})},pe=(0,s.memo)(re(Re,ie.authenticated));var xe=o(c());function fe(){let{isAuth:p,theme:g}=q();return(0,xe.jsx)(pe,{ssrAuthenticated:p,ssrTheme:g})}export{fe as default};
